var assert = require('assert');
var superagent = require('superagent');
var server = require('../server/server');
var status = require('http-status');

describe('Submit a SS request', function() {
  var app;

  before(function() {
    server.start();
  });

  after(function() {
  });

  it('returns a valid id if SS got submitted successfully', function(done) {
    superagent
        .post('http://0.0.0.0:3000/api/v1/WorkRequests/submit')
        .send({ "taskType": "string",   "addresses": [     {       "id": "string",       "addressLine1": "string",       "addressLine2": "string",       "city": "string",       "state": "string",       "zipCode": 0,       "isBilling": true,       "created": "string",       "modified": "string",       "addressType": [         "string"       ],       "isRented": true,       "isPrimary": true,       "phoneNumbers": [         "string"       ]     }   ],   "SSId": "string",   "preferrredTimes": [     "string"   ],   "initialvideo": "string",   "initialaudio": "string",   "images": [     "string"   ],   "description": "string",   "createdTime": "2016-01-23",   "modifiedTime": "2016-01-23",   "chosenWorkflow": {     "id": "string",     "SPOwnerUser": {       "licenseId": "string",       "hasLicense": true,       "verificationComplete": true,       "taskTypesSupported": [         "string"       ],       "rating": 0,       "primaryWorkZipCodes": [         0       ],       "tempWorkZipCodes": [         0       ],       "gender": "string",       "createdTime": "2016-01-23",       "modifiedTime": "2016-01-23",       "race": "string",       "dateOfBirth": "string",       "motherName": "string",       "phoneNumbers": [         "string"       ],       "addresses": [         {           "id": "string",           "addressLine1": "string",           "addressLine2": "string",           "city": "string",           "state": "string",           "zipCode": 0,           "isBilling": true,           "created": "string",           "modified": "string",           "addressType": [             "string"           ],           "isRented": true,           "isPrimary": true,           "phoneNumbers": [             "string"           ]         }       ],       "yearlyEarning": 0,       "websites": [         "string"       ],       "Roles": [         {           "id": 0,           "name": "string",           "description": "string",           "created": "2016-01-23",           "modified": "2016-01-23"         }       ],       "realm": "string",       "username": "string",       "credentials": {},       "challenges": {},       "email": "string",       "emailVerified": true,       "verificationToken": "string",       "status": "string",       "created": "2016-01-23",       "lastUpdated": "2016-01-23",       "id": 0     },     "SPAssignedUser": {       "licenseId": "string",       "hasLicense": true,       "verificationComplete": true,       "taskTypesSupported": [         "string"       ],       "rating": 0,       "primaryWorkZipCodes": [         0       ],       "tempWorkZipCodes": [         0       ],       "gender": "string",       "createdTime": "2016-01-23",       "modifiedTime": "2016-01-23",       "race": "string",       "dateOfBirth": "string",       "motherName": "string",       "phoneNumbers": [         "string"       ],       "addresses": [         {           "id": "string",           "addressLine1": "string",           "addressLine2": "string",           "city": "string",           "state": "string",           "zipCode": 0,           "isBilling": true,           "created": "string",           "modified": "string",           "addressType": [             "string"           ],           "isRented": true,           "isPrimary": true,           "phoneNumbers": [             "string"           ]         }       ],       "yearlyEarning": 0,       "websites": [         "string"       ],       "Roles": [         {           "id": 0,           "name": "string",           "description": "string",           "created": "2016-01-23",           "modified": "2016-01-23"         }       ],       "realm": "string",       "username": "string",       "credentials": {},       "challenges": {},       "email": "string",       "emailVerified": true,       "verificationToken": "string",       "status": "string",       "created": "2016-01-23",       "lastUpdated": "2016-01-23",       "id": 0     },     "SSUser": {       "gender": "string",       "createdTime": "2016-01-23",       "modifiedTime": "2016-01-23",       "race": "string",       "dateOfBirth": "string",       "motherName": "string",       "phoneNumbers": [         "string"       ],       "addresses": [         {           "id": "string",           "addressLine1": "string",           "addressLine2": "string",           "city": "string",           "state": "string",           "zipCode": 0,           "isBilling": true,           "created": "string",           "modified": "string",           "addressType": [             "string"           ],           "isRented": true,           "isPrimary": true,           "phoneNumbers": [             "string"           ]         }       ],       "yearlyEarning": 0,       "websites": [         "string"       ],       "Roles": [         {           "id": 0,           "name": "string",           "description": "string",           "created": "2016-01-23",           "modified": "2016-01-23"         }       ],       "realm": "string",       "username": "string",       "credentials": {},       "challenges": {},       "email": "string",       "emailVerified": true,       "verificationToken": "string",       "status": "string",       "created": "2016-01-23",       "lastUpdated": "2016-01-23",       "id": 0     },     "state": {       "id": 0     },     "quotes": [       "string"     ],     "workRequest": {},     "_state": {       "id": 0     }   },   "respWaitingWorkflowIds": [     {       "id": "string",       "SPOwnerUser": {         "licenseId": "string",         "hasLicense": true,         "verificationComplete": true,         "taskTypesSupported": [           "string"         ],         "rating": 0,         "primaryWorkZipCodes": [           0         ],         "tempWorkZipCodes": [           0         ],         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "SPAssignedUser": {         "licenseId": "string",         "hasLicense": true,         "verificationComplete": true,         "taskTypesSupported": [           "string"         ],         "rating": 0,         "primaryWorkZipCodes": [           0         ],         "tempWorkZipCodes": [           0         ],         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "SSUser": {         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "state": {         "id": 0       },       "quotes": [         "string"       ],       "workRequest": {},       "_state": {         "id": 0       }     }   ],   "removedWorkflowIds": [     {       "id": "string",       "SPOwnerUser": {         "licenseId": "string",         "hasLicense": true,         "verificationComplete": true,         "taskTypesSupported": [           "string"         ],         "rating": 0,         "primaryWorkZipCodes": [           0         ],         "tempWorkZipCodes": [           0         ],         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "SPAssignedUser": {         "licenseId": "string",         "hasLicense": true,         "verificationComplete": true,         "taskTypesSupported": [           "string"         ],         "rating": 0,         "primaryWorkZipCodes": [           0         ],         "tempWorkZipCodes": [           0         ],         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "SSUser": {         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "state": {         "id": 0       },       "quotes": [         "string"       ],       "workRequest": {},       "_state": {         "id": 0       }     }   ],   "respPostponedWorkflowIdList": [     {       "id": "string",       "SPOwnerUser": {         "licenseId": "string",         "hasLicense": true,         "verificationComplete": true,         "taskTypesSupported": [           "string"         ],         "rating": 0,         "primaryWorkZipCodes": [           0         ],         "tempWorkZipCodes": [           0         ],         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "SPAssignedUser": {         "licenseId": "string",         "hasLicense": true,         "verificationComplete": true,         "taskTypesSupported": [           "string"         ],         "rating": 0,         "primaryWorkZipCodes": [           0         ],         "tempWorkZipCodes": [           0         ],         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "SSUser": {         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "state": {         "id": 0       },       "quotes": [         "string"       ],       "workRequest": {},       "_state": {         "id": 0       }     }   ],   "connectedWorkflowIdList": [     {       "id": "string",       "SPOwnerUser": {         "licenseId": "string",         "hasLicense": true,         "verificationComplete": true,         "taskTypesSupported": [           "string"         ],         "rating": 0,         "primaryWorkZipCodes": [           0         ],         "tempWorkZipCodes": [           0         ],         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "SPAssignedUser": {         "licenseId": "string",         "hasLicense": true,         "verificationComplete": true,         "taskTypesSupported": [           "string"         ],         "rating": 0,         "primaryWorkZipCodes": [           0         ],         "tempWorkZipCodes": [           0         ],         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "SSUser": {         "gender": "string",         "createdTime": "2016-01-23",         "modifiedTime": "2016-01-23",         "race": "string",         "dateOfBirth": "string",         "motherName": "string",         "phoneNumbers": [           "string"         ],         "addresses": [           {             "id": "string",             "addressLine1": "string",             "addressLine2": "string",             "city": "string",             "state": "string",             "zipCode": 0,             "isBilling": true,             "created": "string",             "modified": "string",             "addressType": [               "string"             ],             "isRented": true,             "isPrimary": true,             "phoneNumbers": [               "string"             ]           }         ],         "yearlyEarning": 0,         "websites": [           "string"         ],         "Roles": [           {             "id": 0,             "name": "string",             "description": "string",             "created": "2016-01-23",             "modified": "2016-01-23"           }         ],         "realm": "string",         "username": "string",         "credentials": {},         "challenges": {},         "email": "string",         "emailVerified": true,         "verificationToken": "string",         "status": "string",         "created": "2016-01-23",         "lastUpdated": "2016-01-23",         "id": 0       },       "state": {         "id": 0       },       "quotes": [         "string"       ],       "workRequest": {},       "_state": {         "id": 0       }     }   ] })
        .set('Accept', 'application/json')
        .end(function(err, res) {
      assert.ifError(err);
      assert.equal(res.status, status.OK);
      var result = JSON.parse(res.text);
      assert.deepEqual({ user: 'test' }, result);
      done();
    });
  });

  it('returns 404 if user named `params.name` not found', function(done) {
    users.list = ['test'];
    superagent.get('http://localhost:3000/user/notfound').end(function(err, res) {
      assert.ifError(err);
      assert.equal(res.status, status.NOT_FOUND);
      var result = JSON.parse(res.text);
      assert.deepEqual({ error: 'Not Found' }, result);
      done();
    });
  });
});